@tailwind base;
@tailwind components;
@tailwind utilities;

/* ── Dual Theme System: CSS Custom Property Overrides ───────────
   When .theme-onshore is on the root element, all slate colors
   automatically shift to warm stone/zinc tones. This gives full
   theme coverage for all 213+ bg-slate-* / text-slate-* / border-slate-*
   references without touching ANY component JSX.

   Offshore (default) = cool navy slate (Tailwind defaults)
   Onshore = warm stone/earth tones
──────────────────────────────────────────────────────────────── */

/* ── Default: Offshore palette (Tailwind slate defaults — no override needed) ── */
.theme-offshore {
  /* Uses Tailwind defaults — no custom properties needed */
}

/* ── Onshore: Warm stone/earth palette ── */
/* Tailwind v3 uses --tw-<color>-opacity internally for colors.
   We override the compiled RGB values that bg-slate-* compiles to. */
.theme-onshore {
  /* Background color overrides: slate → stone/warm tones */
  /* bg-slate-950 → stone-950 */
  --tw-slate-950: 12 10 9;
  /* stone-950: #0c0a09 */
  /* bg-slate-900 → stone-900 */
  --tw-slate-900: 28 25 23;
  /* stone-900: #1c1917 */
  /* bg-slate-800 → stone-800 */
  --tw-slate-800: 41 37 36;
  /* stone-800: #292524 */
  /* bg-slate-700 → stone-700 */
  --tw-slate-700: 68 64 60;
  /* stone-700: #44403c */
  /* bg-slate-600 → stone-600 */
  --tw-slate-600: 87 83 78;
  /* stone-600: #57534e */
  /* bg-slate-500 → stone-500 */
  --tw-slate-500: 120 113 108;
  /* stone-500: #78716c */
  /* bg-slate-400 → warm-400 (slightly warmer than stone) */
  --tw-slate-400: 168 162 158;
  /* stone-400: #a8a29e */
  /* bg-slate-300 → stone-300 */
  --tw-slate-300: 214 211 209;
  /* stone-300: #d6d3d1 */
  /* bg-slate-200 → stone-200 */
  --tw-slate-200: 231 229 228;
  /* stone-200: #e7e5e4 */
  /* bg-slate-100 → stone-100 */
  --tw-slate-100: 245 245 244;
  /* stone-100: #f5f5f4 */
  /* bg-slate-50 → stone-50 */
  --tw-slate-50: 250 250 249;
  /* stone-50: #fafaf9 */
}

/* Apply the custom property overrides via Tailwind utility-level CSS.
   Since Tailwind v3 compiles colors inline (not using CSS custom props),
   we use a targeted override strategy for the most-used values. */
.theme-onshore .bg-slate-950,
.theme-onshore.bg-slate-950 {
  --tw-bg-opacity: 1;
  background-color: rgb(12 10 9 / var(--tw-bg-opacity));
}

.theme-onshore .bg-slate-900,
.theme-onshore.bg-slate-900 {
  --tw-bg-opacity: 1;
  background-color: rgb(28 25 23 / var(--tw-bg-opacity));
}

.theme-onshore .bg-slate-900\/80,
.theme-onshore.bg-slate-900\/80 {
  background-color: rgb(28 25 23 / 0.8);
}

.theme-onshore .bg-slate-900\/70,
.theme-onshore.bg-slate-900\/70 {
  background-color: rgb(28 25 23 / 0.7);
}

.theme-onshore .bg-slate-900\/50,
.theme-onshore.bg-slate-900\/50 {
  background-color: rgb(28 25 23 / 0.5);
}

.theme-onshore .bg-slate-900\/60,
.theme-onshore.bg-slate-900\/60 {
  background-color: rgb(28 25 23 / 0.6);
}

.theme-onshore .bg-slate-900\/90,
.theme-onshore.bg-slate-900\/90 {
  background-color: rgb(28 25 23 / 0.9);
}

.theme-onshore .bg-slate-800,
.theme-onshore.bg-slate-800 {
  --tw-bg-opacity: 1;
  background-color: rgb(41 37 36 / var(--tw-bg-opacity));
}

.theme-onshore .bg-slate-800\/50,
.theme-onshore.bg-slate-800\/50 {
  background-color: rgb(41 37 36 / 0.5);
}

.theme-onshore .bg-slate-800\/60,
.theme-onshore.bg-slate-800\/60 {
  background-color: rgb(41 37 36 / 0.6);
}

.theme-onshore .bg-slate-800\/40,
.theme-onshore.bg-slate-800\/40 {
  background-color: rgb(41 37 36 / 0.4);
}

.theme-onshore .bg-slate-700,
.theme-onshore.bg-slate-700 {
  --tw-bg-opacity: 1;
  background-color: rgb(68 64 60 / var(--tw-bg-opacity));
}

/* Text color overrides */
.theme-onshore .text-slate-300,
.theme-onshore.text-slate-300 {
  --tw-text-opacity: 1;
  color: rgb(214 211 209 / var(--tw-text-opacity));
}

.theme-onshore .text-slate-400,
.theme-onshore.text-slate-400 {
  --tw-text-opacity: 1;
  color: rgb(168 162 158 / var(--tw-text-opacity));
}

.theme-onshore .text-slate-500,
.theme-onshore.text-slate-500 {
  --tw-text-opacity: 1;
  color: rgb(120 113 108 / var(--tw-text-opacity));
}

.theme-onshore .text-slate-600,
.theme-onshore.text-slate-600 {
  --tw-text-opacity: 1;
  color: rgb(87 83 78 / var(--tw-text-opacity));
}

.theme-onshore .text-slate-700,
.theme-onshore.text-slate-700 {
  --tw-text-opacity: 1;
  color: rgb(68 64 60 / var(--tw-text-opacity));
}

/* Border color overrides */
.theme-onshore .border-slate-700,
.theme-onshore.border-slate-700 {
  --tw-border-opacity: 1;
  border-color: rgb(68 64 60 / var(--tw-border-opacity));
}

.theme-onshore .border-slate-800,
.theme-onshore.border-slate-800 {
  --tw-border-opacity: 1;
  border-color: rgb(41 37 36 / var(--tw-border-opacity));
}

/* ── Theme transition — smooth color changes when switching ── */
/* Only transition the root containers; children inherit color instantly.
   The old `*` selector caused massive jank by creating composite layers
   on every DOM element during theme switches. */
.theme-onshore,
.theme-offshore {
  transition: background-color 500ms ease, color 500ms ease, border-color 500ms ease;
}

/* Custom Scrollbars for Glassmorphism */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 10px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.4);
}

/* Hide Scrollbars Completely */
.no-scrollbar {
  scrollbar-width: none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE and Edge */
}

.no-scrollbar::-webkit-scrollbar {
  display: none;
  /* Chrome, Safari, Opera */
}

/* App Shell Reset */
html,
body,
#root {
  height: 100%;
  width: 100%;
  overflow-y: auto;
  /* Allow vertical scroll */
  overscroll-behavior-y: none;
  /* Prevent bounce */
  -webkit-overflow-scrolling: touch;
  /* Momentum scrolling */
}

/* Ensure dynamic viewport units are respected where supported */
@supports (height: 100dvh) {

  html,
  body,
  #root {
    min-height: 100dvh;
  }
}

/* RESPONSIVE SCALING: Fluid Root Font Size */
/* This limits the scaling to Mobile range (320px - 450px) */
/* On iPhone SE (375px), font will be ~15px. On Pro Max (430px), ~17px. */
@media screen and (max-width: 768px) {
  html {
    font-size: clamp(13px, 4vw, 17px);
  }
}

/* Animations matching the 'tailwindcss-animate' style classes used in React components */
.animate-in {
  animation-duration: 0.5s;
  animation-fill-mode: both;
  animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

.fade-in {
  animation-name: fadeIn;
}

.slide-in-from-bottom-4 {
  --tw-enter-translate-y: 1rem;
  animation-name: slideInBottom;
}

.slide-in-from-bottom-8 {
  --tw-enter-translate-y: 2rem;
  animation-name: slideInBottom;
}

.slide-in-from-right-4 {
  --tw-enter-translate-x: 1rem;
  animation-name: slideInRight;
}

.slide-in-from-right-8 {
  --tw-enter-translate-x: 2rem;
  animation-name: slideInRight;
}

.slide-in-from-top-2 {
  --tw-enter-translate-y: -0.5rem;
  animation-name: slideInTop;
}

.zoom-in-95 {
  --tw-enter-scale: 0.95;
  animation-name: zoomIn;
}

.zoom-in {
  --tw-enter-scale: 0.95;
  animation-name: zoomIn;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

@keyframes slideInBottom {
  from {
    transform: translateY(var(--tw-enter-translate-y, 100%));
    opacity: 0;
  }

  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slideInTop {
  from {
    transform: translateY(var(--tw-enter-translate-y, -100%));
    opacity: 0;
  }

  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slideInRight {
  from {
    transform: translateX(var(--tw-enter-translate-x, 100%));
    opacity: 0;
  }

  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes zoomIn {
  from {
    transform: scale(var(--tw-enter-scale, 0.95));
    opacity: 0;
  }

  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* ── Page Transition Animation ── */
@keyframes pageEnter {
  from {
    opacity: 0;
    transform: translateY(8px) scale(0.99);
  }

  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.page-enter {
  animation: pageEnter 200ms cubic-bezier(0.2, 0, 0, 1) both;
}

/* ── Leaflet MarkerCluster Overrides ── */
.custom-cluster-icon {
  background: transparent !important;
  border: none !important;
}

.marker-cluster-small,
.marker-cluster-medium,
.marker-cluster-large {
  background: transparent !important;
}

.marker-cluster-small div,
.marker-cluster-medium div,
.marker-cluster-large div {
  background: transparent !important;
}

.leaflet-cluster-anim .leaflet-marker-icon,
.leaflet-cluster-anim .leaflet-marker-shadow {
  transition: transform 0.25s ease-out, opacity 0.25s ease-out !important;
}

/* ── Reduced motion ── */
@media (prefers-reduced-motion: reduce) {

  .animate-in,
  .page-enter,
  .fade-in,
  .slide-in-from-bottom-4,
  .slide-in-from-bottom-8,
  .slide-in-from-right-4,
  .slide-in-from-right-8,
  .slide-in-from-top-2,
  .zoom-in-95,
  .zoom-in {
    animation: none !important;
    transition: none !important;
  }
}

/* ── Safe Area Utilities ── */
.safe-top {
  padding-top: env(safe-area-inset-top, 0px);
}

.safe-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.safe-left {
  padding-left: env(safe-area-inset-left, 0px);
}

.safe-right {
  padding-right: env(safe-area-inset-right, 0px);
}

.safe-x {
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
}

.safe-y {
  padding-top: env(safe-area-inset-top, 0px);
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.safe-all {
  padding-top: env(safe-area-inset-top, 0px);
  padding-right: env(safe-area-inset-right, 0px);
  padding-bottom: env(safe-area-inset-bottom, 0px);
  padding-left: env(safe-area-inset-left, 0px);
}

/* ── Modal Transition Animations ── */
@keyframes modalBackdropEnter {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}

@keyframes modalPanelEnter {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(8px);
  }

  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.modal-backdrop-enter {
  animation: modalBackdropEnter 150ms ease-out both;
}

.modal-panel-enter {
  animation: modalPanelEnter 200ms cubic-bezier(0.34, 1.56, 0.64, 1) both;
}

/* ── Tablet / iPad Chart-Plotter Optimizations (768px+) ── */
@media screen and (min-width: 768px) {

  /* Larger tap targets for chart plotter */
  .tablet-touch {
    min-height: 56px;
    min-width: 56px;
  }

  /* Multi-column layouts for wider screens */
  .tablet-grid-2 {
    grid-template-columns: repeat(2, 1fr);
  }

  .tablet-grid-3 {
    grid-template-columns: repeat(3, 1fr);
  }

  /* Wider content area */
  .tablet-wide {
    max-width: 960px;
    margin: 0 auto;
  }

  /* Larger modals on tablet */
  .tablet-modal {
    max-width: 600px;
  }

  /* Larger text for chart plotter readability */
  .tablet-text-lg {
    font-size: 1.125rem;
  }
}

/* ── Reduced Motion — respect user preference ── */
@media (prefers-reduced-motion: reduce) {

  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  .theme-onshore,
  .theme-offshore {
    transition: none !important;
  }
}

/* ── Skip Navigation Link — keyboard accessibility ── */
.skip-nav {
  position: absolute;
  top: -40px;
  left: 0;
  background: #0ea5e9;
  color: white;
  padding: 8px 16px;
  z-index: 99999;
  font-weight: 700;
  font-size: 14px;
  border-radius: 0 0 8px 0;
  transition: top 0.2s;
}

.skip-nav:focus {
  top: 0;
}

/* ── Focus-Visible — keyboard accessibility ring ── */
/* Show a visible ring only for keyboard navigation (not mouse/touch) */
*:focus-visible {
  outline: 2px solid rgba(56, 189, 248, 0.8);
  /* sky-400 */
  outline-offset: 2px;
  border-radius: 4px;
}

/* Dark background variant — stronger glow */
.bg-slate-900 *:focus-visible,
.bg-slate-950 *:focus-visible,
.bg-black *:focus-visible {
  outline-color: rgba(56, 189, 248, 0.9);
  box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.15);
}

/* Suppress outline for mouse/touch interactions */
*:focus:not(:focus-visible) {
  outline: none;
}

/* Action sheet slide-up animation */
@keyframes slideUp {
  from {
    transform: translateY(100%);
    opacity: 0;
  }

  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* GPS dedup feedback badge animations */
@keyframes dedupFadeIn {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes dedupFadeOut {
  from {
    opacity: 1;
  }

  to {
    opacity: 0;
  }
}