/**
 * Polar Database — Theoretical polar data for common production sailboats.
 * Wind speeds in knots, angles in degrees, matrix values = boat speed (kts).
 * Sources: ORC data, sail designer estimates, and published polar tables.
 *
 * Matrix layout: matrix[angleIdx][windSpeedIdx]
 * Standard wind speeds: [6, 8, 10, 12, 15, 20, 25]
 * Standard angles: [45, 60, 90, 120, 150, 180]
 */
import type { PolarData } from '../types';

export interface PolarDatabaseEntry {
    model: string;           // e.g. "Beneteau Oceanis 38.1"
    manufacturer: string;    // e.g. "Beneteau"
    loa: number;             // Length overall (ft)
    category: 'cruiser' | 'racer-cruiser' | 'racer' | 'multihull';
    polar: PolarData;
}

// Standard wind speeds and angles used across all entries
const STD_WINDS = [6, 8, 10, 12, 15, 20, 25];
const STD_ANGLES = [45, 60, 90, 120, 150, 180];

const p = (matrix: number[][]): PolarData => ({
    windSpeeds: STD_WINDS,
    angles: STD_ANGLES,
    matrix,
});

export const POLAR_DATABASE: PolarDatabaseEntry[] = [
    // ═══════════════════════════════════════════
    // BENETEAU
    // ═══════════════════════════════════════════
    {
        model: 'Beneteau Oceanis 38.1', manufacturer: 'Beneteau', loa: 38, category: 'cruiser',
        polar: p([
            [4.2, 5.1, 5.8, 6.2, 6.5, 6.4, 6.0],  // 45°
            [4.8, 5.7, 6.4, 6.9, 7.2, 7.1, 6.7],  // 60°
            [5.2, 6.2, 7.0, 7.5, 7.9, 7.8, 7.3],  // 90°
            [5.0, 6.0, 6.8, 7.3, 7.7, 7.6, 7.1],  // 120°
            [4.4, 5.3, 6.0, 6.5, 6.9, 6.8, 6.4],  // 150°
            [3.8, 4.6, 5.2, 5.6, 5.9, 5.8, 5.5],  // 180°
        ]),
    },
    {
        model: 'Beneteau Oceanis 40.1', manufacturer: 'Beneteau', loa: 40, category: 'cruiser',
        polar: p([
            [4.3, 5.2, 5.9, 6.3, 6.7, 6.6, 6.2],
            [4.9, 5.8, 6.5, 7.0, 7.4, 7.3, 6.9],
            [5.4, 6.4, 7.2, 7.7, 8.1, 8.0, 7.5],
            [5.2, 6.2, 7.0, 7.5, 7.9, 7.8, 7.3],
            [4.6, 5.5, 6.2, 6.7, 7.1, 7.0, 6.6],
            [4.0, 4.8, 5.4, 5.8, 6.1, 6.0, 5.7],
        ]),
    },
    {
        model: 'Beneteau Oceanis 46.1', manufacturer: 'Beneteau', loa: 46, category: 'cruiser',
        polar: p([
            [4.5, 5.4, 6.1, 6.6, 7.0, 6.9, 6.5],
            [5.1, 6.1, 6.8, 7.3, 7.7, 7.6, 7.2],
            [5.6, 6.7, 7.5, 8.0, 8.5, 8.4, 7.9],
            [5.4, 6.5, 7.3, 7.8, 8.2, 8.1, 7.6],
            [4.8, 5.7, 6.5, 7.0, 7.4, 7.3, 6.9],
            [4.2, 5.0, 5.7, 6.1, 6.5, 6.4, 6.0],
        ]),
    },
    {
        model: 'Beneteau First 36', manufacturer: 'Beneteau', loa: 36, category: 'racer-cruiser',
        polar: p([
            [4.8, 5.7, 6.4, 6.9, 7.2, 7.0, 6.5],
            [5.4, 6.4, 7.2, 7.7, 8.1, 7.9, 7.4],
            [5.8, 6.9, 7.8, 8.3, 8.8, 8.6, 8.0],
            [5.6, 6.7, 7.5, 8.0, 8.5, 8.3, 7.7],
            [5.0, 5.9, 6.7, 7.2, 7.6, 7.4, 6.9],
            [4.3, 5.1, 5.8, 6.2, 6.6, 6.4, 6.0],
        ]),
    },

    // ═══════════════════════════════════════════
    // JEANNEAU
    // ═══════════════════════════════════════════
    {
        model: 'Jeanneau Sun Odyssey 410', manufacturer: 'Jeanneau', loa: 41, category: 'cruiser',
        polar: p([
            [4.3, 5.2, 5.9, 6.4, 6.8, 6.7, 6.3],
            [4.9, 5.9, 6.6, 7.1, 7.5, 7.4, 7.0],
            [5.4, 6.4, 7.2, 7.8, 8.2, 8.1, 7.6],
            [5.2, 6.2, 7.0, 7.5, 8.0, 7.9, 7.4],
            [4.6, 5.5, 6.2, 6.7, 7.1, 7.0, 6.6],
            [4.0, 4.8, 5.4, 5.9, 6.2, 6.1, 5.8],
        ]),
    },
    {
        model: 'Jeanneau Sun Odyssey 440', manufacturer: 'Jeanneau', loa: 44, category: 'cruiser',
        polar: p([
            [4.4, 5.3, 6.0, 6.5, 6.9, 6.8, 6.4],
            [5.0, 6.0, 6.7, 7.2, 7.6, 7.5, 7.1],
            [5.5, 6.6, 7.4, 7.9, 8.4, 8.3, 7.8],
            [5.3, 6.4, 7.2, 7.7, 8.1, 8.0, 7.5],
            [4.7, 5.6, 6.4, 6.9, 7.3, 7.2, 6.8],
            [4.1, 4.9, 5.6, 6.0, 6.4, 6.3, 5.9],
        ]),
    },
    {
        model: 'Jeanneau Sun Odyssey 490', manufacturer: 'Jeanneau', loa: 49, category: 'cruiser',
        polar: p([
            [4.6, 5.5, 6.2, 6.7, 7.1, 7.0, 6.6],
            [5.2, 6.2, 6.9, 7.5, 7.9, 7.8, 7.4],
            [5.7, 6.8, 7.6, 8.2, 8.7, 8.6, 8.1],
            [5.5, 6.6, 7.4, 8.0, 8.4, 8.3, 7.8],
            [4.9, 5.8, 6.6, 7.1, 7.5, 7.4, 7.0],
            [4.3, 5.1, 5.8, 6.3, 6.7, 6.6, 6.2],
        ]),
    },

    // ═══════════════════════════════════════════
    // CATALINA
    // ═══════════════════════════════════════════
    {
        model: 'Catalina 30', manufacturer: 'Catalina', loa: 30, category: 'cruiser',
        polar: p([
            [3.5, 4.2, 4.8, 5.2, 5.5, 5.4, 5.0],
            [4.0, 4.8, 5.4, 5.8, 6.2, 6.1, 5.7],
            [4.4, 5.3, 6.0, 6.5, 6.8, 6.7, 6.3],
            [4.2, 5.0, 5.7, 6.2, 6.5, 6.4, 6.0],
            [3.7, 4.4, 5.0, 5.4, 5.7, 5.6, 5.3],
            [3.2, 3.8, 4.4, 4.7, 5.0, 4.9, 4.6],
        ]),
    },
    {
        model: 'Catalina 36', manufacturer: 'Catalina', loa: 36, category: 'cruiser',
        polar: p([
            [3.8, 4.6, 5.2, 5.6, 5.9, 5.8, 5.4],
            [4.3, 5.2, 5.8, 6.3, 6.7, 6.6, 6.2],
            [4.8, 5.7, 6.4, 6.9, 7.3, 7.2, 6.8],
            [4.6, 5.5, 6.2, 6.7, 7.0, 6.9, 6.5],
            [4.0, 4.8, 5.5, 5.9, 6.3, 6.2, 5.8],
            [3.5, 4.2, 4.8, 5.2, 5.5, 5.4, 5.0],
        ]),
    },
    {
        model: 'Catalina 42', manufacturer: 'Catalina', loa: 42, category: 'cruiser',
        polar: p([
            [4.2, 5.0, 5.7, 6.2, 6.6, 6.5, 6.1],
            [4.8, 5.7, 6.4, 6.9, 7.3, 7.2, 6.8],
            [5.2, 6.2, 7.0, 7.5, 7.9, 7.8, 7.3],
            [5.0, 6.0, 6.8, 7.3, 7.7, 7.6, 7.1],
            [4.4, 5.3, 6.0, 6.5, 6.9, 6.8, 6.4],
            [3.8, 4.6, 5.2, 5.7, 6.0, 5.9, 5.6],
        ]),
    },

    // ═══════════════════════════════════════════
    // HALLBERG-RASSY / PREMIUM CRUISERS
    // ═══════════════════════════════════════════
    {
        model: 'Hallberg-Rassy 40C', manufacturer: 'Hallberg-Rassy', loa: 40, category: 'cruiser',
        polar: p([
            [4.1, 5.0, 5.7, 6.1, 6.5, 6.4, 6.0],
            [4.7, 5.6, 6.3, 6.8, 7.2, 7.1, 6.7],
            [5.2, 6.2, 7.0, 7.5, 7.9, 7.8, 7.3],
            [5.0, 6.0, 6.7, 7.2, 7.6, 7.5, 7.1],
            [4.4, 5.3, 5.9, 6.4, 6.8, 6.7, 6.3],
            [3.8, 4.6, 5.2, 5.6, 5.9, 5.8, 5.5],
        ]),
    },
    {
        model: 'Hallberg-Rassy 44', manufacturer: 'Hallberg-Rassy', loa: 44, category: 'cruiser',
        polar: p([
            [4.3, 5.2, 5.9, 6.3, 6.7, 6.6, 6.2],
            [4.9, 5.8, 6.5, 7.0, 7.4, 7.3, 6.9],
            [5.4, 6.4, 7.2, 7.7, 8.1, 8.0, 7.5],
            [5.2, 6.2, 7.0, 7.5, 7.8, 7.7, 7.3],
            [4.6, 5.5, 6.2, 6.7, 7.0, 6.9, 6.5],
            [4.0, 4.8, 5.4, 5.8, 6.2, 6.1, 5.7],
        ]),
    },

    // ═══════════════════════════════════════════
    // TAYANA / BLUEWATER
    // ═══════════════════════════════════════════
    {
        model: 'Tayana 37', manufacturer: 'Tayana', loa: 37, category: 'cruiser',
        polar: p([
            [3.6, 4.4, 5.0, 5.4, 5.7, 5.6, 5.2],
            [4.1, 5.0, 5.6, 6.1, 6.4, 6.3, 5.9],
            [4.6, 5.5, 6.2, 6.7, 7.1, 7.0, 6.5],
            [4.4, 5.3, 6.0, 6.5, 6.8, 6.7, 6.3],
            [3.9, 4.7, 5.3, 5.7, 6.0, 5.9, 5.6],
            [3.4, 4.1, 4.6, 5.0, 5.3, 5.2, 4.9],
        ]),
    },
    {
        model: 'Tayana 48', manufacturer: 'Tayana', loa: 48, category: 'cruiser',
        polar: p([
            [4.0, 4.8, 5.5, 5.9, 6.3, 6.2, 5.8],
            [4.6, 5.5, 6.2, 6.7, 7.1, 7.0, 6.6],
            [5.0, 6.0, 6.8, 7.3, 7.7, 7.6, 7.1],
            [4.8, 5.8, 6.5, 7.0, 7.4, 7.3, 6.9],
            [4.3, 5.1, 5.8, 6.3, 6.6, 6.5, 6.1],
            [3.7, 4.5, 5.1, 5.5, 5.8, 5.7, 5.4],
        ]),
    },
    {
        model: 'Tayana 55', manufacturer: 'Tayana', loa: 55, category: 'cruiser',
        polar: p([
            [4.3, 5.2, 5.9, 6.3, 6.7, 6.6, 6.2],
            [4.9, 5.9, 6.6, 7.1, 7.5, 7.4, 7.0],
            [5.4, 6.5, 7.3, 7.8, 8.2, 8.1, 7.6],
            [5.2, 6.3, 7.0, 7.5, 7.9, 7.8, 7.4],
            [4.6, 5.5, 6.2, 6.7, 7.1, 7.0, 6.6],
            [4.0, 4.8, 5.5, 5.9, 6.3, 6.2, 5.8],
        ]),
    },

    // ═══════════════════════════════════════════
    // SWAN / PERFORMANCE CRUISERS
    // ═══════════════════════════════════════════
    {
        model: 'Swan 48', manufacturer: 'Nautor Swan', loa: 48, category: 'racer-cruiser',
        polar: p([
            [5.0, 5.9, 6.7, 7.2, 7.6, 7.5, 7.0],
            [5.6, 6.7, 7.5, 8.0, 8.5, 8.3, 7.8],
            [6.1, 7.3, 8.2, 8.8, 9.3, 9.1, 8.5],
            [5.9, 7.0, 7.9, 8.4, 8.9, 8.7, 8.2],
            [5.2, 6.2, 7.0, 7.5, 7.9, 7.7, 7.2],
            [4.5, 5.4, 6.1, 6.5, 6.9, 6.7, 6.3],
        ]),
    },
    {
        model: 'Swan 54', manufacturer: 'Nautor Swan', loa: 54, category: 'racer-cruiser',
        polar: p([
            [5.2, 6.2, 7.0, 7.5, 7.9, 7.8, 7.3],
            [5.9, 7.0, 7.8, 8.4, 8.9, 8.7, 8.2],
            [6.4, 7.6, 8.5, 9.1, 9.6, 9.4, 8.8],
            [6.2, 7.3, 8.2, 8.8, 9.3, 9.1, 8.5],
            [5.5, 6.5, 7.3, 7.9, 8.3, 8.1, 7.6],
            [4.8, 5.7, 6.4, 6.9, 7.3, 7.1, 6.7],
        ]),
    },

    // ═══════════════════════════════════════════
    // J BOATS (RACING)
    // ═══════════════════════════════════════════
    {
        model: 'J/24', manufacturer: 'J Boats', loa: 24, category: 'racer',
        polar: p([
            [3.8, 4.6, 5.2, 5.6, 5.8, 5.6, 5.0],
            [4.3, 5.2, 5.9, 6.3, 6.6, 6.4, 5.8],
            [4.8, 5.7, 6.4, 6.9, 7.2, 7.0, 6.4],
            [4.5, 5.4, 6.1, 6.6, 6.9, 6.7, 6.1],
            [3.9, 4.7, 5.3, 5.7, 6.0, 5.8, 5.3],
            [3.3, 4.0, 4.5, 4.9, 5.2, 5.0, 4.6],
        ]),
    },
    {
        model: 'J/70', manufacturer: 'J Boats', loa: 23, category: 'racer',
        polar: p([
            [4.2, 5.1, 5.8, 6.2, 6.5, 6.2, 5.5],
            [4.8, 5.8, 6.5, 7.0, 7.3, 7.0, 6.3],
            [5.3, 6.3, 7.1, 7.6, 8.0, 7.7, 7.0],
            [5.0, 6.0, 6.8, 7.3, 7.6, 7.3, 6.6],
            [4.4, 5.3, 6.0, 6.4, 6.7, 6.4, 5.8],
            [3.8, 4.5, 5.1, 5.5, 5.8, 5.5, 5.0],
        ]),
    },
    {
        model: 'J/105', manufacturer: 'J Boats', loa: 35, category: 'racer',
        polar: p([
            [4.8, 5.7, 6.5, 7.0, 7.4, 7.2, 6.7],
            [5.4, 6.5, 7.3, 7.8, 8.2, 8.0, 7.5],
            [6.0, 7.1, 8.0, 8.6, 9.0, 8.8, 8.2],
            [5.7, 6.8, 7.7, 8.2, 8.7, 8.5, 7.9],
            [5.1, 6.0, 6.8, 7.3, 7.7, 7.5, 7.0],
            [4.4, 5.2, 5.9, 6.4, 6.7, 6.5, 6.1],
        ]),
    },
    {
        model: 'J/111', manufacturer: 'J Boats', loa: 36, category: 'racer',
        polar: p([
            [5.0, 6.0, 6.8, 7.3, 7.7, 7.5, 7.0],
            [5.7, 6.8, 7.6, 8.2, 8.6, 8.4, 7.8],
            [6.2, 7.4, 8.3, 8.9, 9.4, 9.2, 8.6],
            [6.0, 7.1, 8.0, 8.6, 9.1, 8.9, 8.3],
            [5.3, 6.3, 7.1, 7.6, 8.0, 7.8, 7.3],
            [4.6, 5.5, 6.2, 6.7, 7.0, 6.8, 6.4],
        ]),
    },

    // ═══════════════════════════════════════════
    // BAVARIA
    // ═══════════════════════════════════════════
    {
        model: 'Bavaria C38', manufacturer: 'Bavaria', loa: 38, category: 'cruiser',
        polar: p([
            [4.0, 4.8, 5.5, 5.9, 6.3, 6.2, 5.8],
            [4.6, 5.5, 6.2, 6.7, 7.0, 6.9, 6.5],
            [5.0, 6.0, 6.8, 7.3, 7.7, 7.6, 7.1],
            [4.8, 5.8, 6.5, 7.0, 7.4, 7.3, 6.9],
            [4.3, 5.1, 5.8, 6.2, 6.6, 6.5, 6.1],
            [3.7, 4.4, 5.0, 5.4, 5.7, 5.6, 5.3],
        ]),
    },
    {
        model: 'Bavaria C42', manufacturer: 'Bavaria', loa: 42, category: 'cruiser',
        polar: p([
            [4.2, 5.0, 5.7, 6.2, 6.5, 6.4, 6.0],
            [4.8, 5.7, 6.4, 6.9, 7.3, 7.2, 6.8],
            [5.3, 6.3, 7.1, 7.6, 8.0, 7.9, 7.4],
            [5.1, 6.1, 6.8, 7.3, 7.7, 7.6, 7.1],
            [4.5, 5.4, 6.1, 6.5, 6.9, 6.8, 6.4],
            [3.9, 4.7, 5.3, 5.7, 6.0, 5.9, 5.6],
        ]),
    },

    // ═══════════════════════════════════════════
    // HANSE
    // ═══════════════════════════════════════════
    {
        model: 'Hanse 388', manufacturer: 'Hanse', loa: 38, category: 'cruiser',
        polar: p([
            [4.3, 5.2, 5.9, 6.3, 6.7, 6.6, 6.2],
            [4.9, 5.8, 6.6, 7.1, 7.5, 7.4, 6.9],
            [5.3, 6.4, 7.2, 7.7, 8.1, 8.0, 7.5],
            [5.1, 6.1, 6.9, 7.4, 7.8, 7.7, 7.2],
            [4.5, 5.4, 6.1, 6.6, 7.0, 6.9, 6.5],
            [3.9, 4.7, 5.3, 5.7, 6.1, 6.0, 5.6],
        ]),
    },
    {
        model: 'Hanse 460', manufacturer: 'Hanse', loa: 46, category: 'cruiser',
        polar: p([
            [4.5, 5.4, 6.1, 6.6, 7.0, 6.9, 6.5],
            [5.1, 6.1, 6.8, 7.4, 7.8, 7.7, 7.2],
            [5.6, 6.7, 7.5, 8.1, 8.5, 8.4, 7.9],
            [5.4, 6.5, 7.3, 7.8, 8.2, 8.1, 7.6],
            [4.8, 5.7, 6.5, 7.0, 7.4, 7.3, 6.9],
            [4.2, 5.0, 5.7, 6.1, 6.5, 6.4, 6.0],
        ]),
    },

    // ═══════════════════════════════════════════
    // MULTIHULLS
    // ═══════════════════════════════════════════
    {
        model: 'Lagoon 42', manufacturer: 'Lagoon', loa: 42, category: 'multihull',
        polar: p([
            [4.5, 5.4, 6.2, 6.7, 7.1, 7.0, 6.5],
            [5.2, 6.2, 7.0, 7.6, 8.0, 7.9, 7.4],
            [5.8, 6.9, 7.8, 8.4, 8.9, 8.8, 8.2],
            [5.6, 6.7, 7.5, 8.1, 8.6, 8.5, 7.9],
            [4.9, 5.9, 6.7, 7.2, 7.6, 7.5, 7.0],
            [4.2, 5.0, 5.7, 6.1, 6.5, 6.4, 6.0],
        ]),
    },
    {
        model: 'Fountaine Pajot Elba 45', manufacturer: 'Fountaine Pajot', loa: 45, category: 'multihull',
        polar: p([
            [4.8, 5.7, 6.5, 7.0, 7.4, 7.3, 6.8],
            [5.5, 6.5, 7.3, 7.9, 8.4, 8.3, 7.7],
            [6.0, 7.2, 8.1, 8.7, 9.2, 9.1, 8.5],
            [5.8, 6.9, 7.8, 8.4, 8.9, 8.8, 8.2],
            [5.1, 6.1, 6.9, 7.5, 7.9, 7.8, 7.3],
            [4.4, 5.3, 6.0, 6.5, 6.9, 6.8, 6.4],
        ]),
    },

    // ═══════════════════════════════════════════
    // CLASSIC / MISC
    // ═══════════════════════════════════════════
    {
        model: 'Contessa 32', manufacturer: 'Jeremy Rogers', loa: 32, category: 'racer-cruiser',
        polar: p([
            [3.7, 4.5, 5.1, 5.5, 5.8, 5.7, 5.3],
            [4.2, 5.1, 5.7, 6.2, 6.5, 6.4, 6.0],
            [4.7, 5.6, 6.3, 6.8, 7.2, 7.1, 6.6],
            [4.5, 5.4, 6.1, 6.6, 6.9, 6.8, 6.4],
            [4.0, 4.8, 5.4, 5.8, 6.1, 6.0, 5.6],
            [3.4, 4.1, 4.7, 5.0, 5.3, 5.2, 4.9],
        ]),
    },
    {
        model: 'Island Packet 37', manufacturer: 'Island Packet', loa: 37, category: 'cruiser',
        polar: p([
            [3.4, 4.1, 4.7, 5.1, 5.4, 5.3, 5.0],
            [3.9, 4.7, 5.3, 5.7, 6.1, 6.0, 5.6],
            [4.3, 5.2, 5.9, 6.3, 6.7, 6.6, 6.2],
            [4.1, 5.0, 5.6, 6.1, 6.4, 6.3, 5.9],
            [3.6, 4.4, 5.0, 5.4, 5.7, 5.6, 5.2],
            [3.1, 3.8, 4.3, 4.7, 5.0, 4.9, 4.6],
        ]),
    },
    {
        model: 'Oyster 545', manufacturer: 'Oyster', loa: 55, category: 'cruiser',
        polar: p([
            [4.5, 5.4, 6.1, 6.6, 7.0, 6.9, 6.5],
            [5.1, 6.1, 6.9, 7.4, 7.8, 7.7, 7.2],
            [5.6, 6.7, 7.5, 8.1, 8.5, 8.4, 7.9],
            [5.4, 6.5, 7.3, 7.8, 8.2, 8.1, 7.6],
            [4.8, 5.7, 6.5, 7.0, 7.4, 7.3, 6.9],
            [4.2, 5.0, 5.7, 6.1, 6.5, 6.4, 6.0],
        ]),
    },
];

/** Search the polar database by model name (fuzzy match) */
export function searchPolarDatabase(query: string): PolarDatabaseEntry[] {
    const q = query.toLowerCase().trim();
    if (!q) return POLAR_DATABASE;
    return POLAR_DATABASE.filter(entry =>
        entry.model.toLowerCase().includes(q) ||
        entry.manufacturer.toLowerCase().includes(q)
    );
}
